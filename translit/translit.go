package translit

import (
	"strings"
)

// Transliterate runs the given maps on s and returns the result
func Transliterate(s string, useMaps ...string) string {
	// Create variable to store modified string
	out := s
	// If custom map exists
	if custom, ok := Transliterators["custom"]; ok {
		// Perform transliteration with it
		out = custom.Transliterate(out)
	}
	// For every map to use
	for _, useMap := range useMaps {
		// If custom, skip
		if useMap == "custom" {
			continue
		}
		// Get requested map
		transliterator, ok := Transliterators[useMap]
		if !ok {
			continue
		}
		transliterator.Init()
		// Perform transliteration
		out = transliterator.Transliterate(out)
	}
	// Return result
	return out
}

// Transliterator is implemented by anything with a
// Transliterate method, which performs transliteration
// and returns the resulting string.
type Transliterator interface {
	Transliterate(string) string
	Init()
}

// Map implements Transliterator using a slice where
// every even element is a key and every odd one is a value
// which replaces the key.
type Map []string

func (mt Map) Transliterate(s string) string {
	return strings.NewReplacer(mt...).Replace(s)
}

func (Map) Init() {}

// Transliterators stores transliterator implementations for each supported language.
// Some of these were sourced from https://codeberg.org/Freeyourgadget/Gadgetbridge
var Transliterators = map[string]Transliterator{
	"eASCII": Map{
		"Å“", "oe",
		"Âª", "a",
		"Â°", "o",
		"Â«", `"`,
		"Â»", `"`,
	},
	"Scandinavian": Map{
		"Ã†", "Ae",
		"Ã¦", "ae",
		"Ã˜", "Oe",
		"Ã¸", "oe",
		"Ã…", "Aa",
		"Ã¥", "aa",
	},
	"German": Map{
		"Ã¤", "ae",
		"Ã¶", "oe",
		"Ã¼", "ue",
		"Ã„", "Ae",
		"Ã–", "Oe",
		"Ãœ", "Ue",
		"ÃŸ", "ss",
		"áº", "SS",
	},
	"Hebrew": Map{
		"×", "a",
		"×‘", "b",
		"×’", "g",
		"×“", "d",
		"×”", "h",
		"×•", "u",
		"×–", "z",
		"×—", "kh",
		"×˜", "t",
		"×™", "y",
		"×›", "c",
		"×œ", "l",
		"×", "m",
		"× ", "n",
		"×¡", "s",
		"×¢", "'",
		"×¤", "p",
		"×¦", "ts",
		"×§", "k",
		"×¨", "r",
		"×©", "sh",
		"×ª", "th",
		"×£", "f",
		"×¥", "ts",
		"×š", "ch",
		"×", "m",
		"×Ÿ", "n",
	},
	"Greek": Map{
		"Î±", "a",
		"Î¬", "a",
		"Î²", "v",
		"Î³", "g",
		"Î´", "d",
		"Îµ", "e",
		"Î­", "e",
		"Î¶", "z",
		"Î·", "i",
		"Î®", "i",
		"Î¸", "th",
		"Î¹", "i",
		"Î¯", "i",
		"ÏŠ", "i",
		"Î", "i",
		"Îº", "k",
		"Î»", "l",
		"Î¼", "m",
		"Î½", "n",
		"Î¾", "ks",
		"Î¿", "o",
		"ÏŒ", "o",
		"Ï€", "p",
		"Ï", "r",
		"Ïƒ", "s",
		"Ï‚", "s",
		"Ï„", "t",
		"Ï…", "y",
		"Ï", "y",
		"Ï‹", "y",
		"Î°", "y",
		"Ï†", "f",
		"Ï‡", "ch",
		"Ïˆ", "ps",
		"Ï‰", "o",
		"Ï", "o",
		"Î‘", "A",
		"Î†", "A",
		"Î’", "B",
		"Î“", "G",
		"Î”", "D",
		"Î•", "E",
		"Îˆ", "E",
		"Î–", "Z",
		"Î—", "I",
		"Î‰", "I",
		"Î˜", "Th",
		"Î™", "I",
		"ÎŠ", "I",
		"Îª", "I",
		"Îš", "K",
		"Î›", "L",
		"Îœ", "M",
		"Î", "N",
		"Î", "Ks",
		"ÎŸ", "O",
		"ÎŒ", "O",
		"Î ", "P",
		"Î¡", "R",
		"Î£", "S",
		"Î¤", "T",
		"Î¥", "Y",
		"Î", "Y",
		"Î«", "Y",
		"Î¦", "F",
		"Î§", "Ch",
		"Î¨", "Ps",
		"Î©", "O",
		"Î", "O",
	},
	"Russian": Map{
		"Ğ", "Ğ™o",
		"Ñ‘", "Ğ¹o",
	},
	"Ukranian": Map{
		"Ò‘", "gh",
		"Ñ”", "je",
		"Ñ–", "i",
		"Ñ—", "ji",
		"Ò", "Gh",
		"Ğ„", "Je",
		"Ğ†", "I",
		"Ğ‡", "JI",
	},
	"Arabic": Map{
		"Ø§", "a",
		"Ø¨", "b",
		"Øª", "t",
		"Ø«", "th",
		"Ø¬", "j",
		"Ø­", "7",
		"Ø®", "5",
		"Ø¯", "d",
		"Ø°", "th",
		"Ø±", "r",
		"Ø²", "z",
		"Ø³", "s",
		"Ø´", "sh",
		"Øµ", "9",
		"Ø¶", "9'",
		"Ø·", "6",
		"Ø¸", "6'",
		"Ø¹", "3",
		"Øº", "3'",
		"Ù", "f",
		"Ù‚", "q",
		"Ùƒ", "k",
		"Ù„", "l",
		"Ù…", "m",
		"Ù†", "n",
		"Ù‡", "h",
		"Ùˆ", "w",
		"ÙŠ", "y",
		"Ù‰", "a",
		"ïº“", "",
		"Ø¢", "2",
		"Ø¦", "2",
		"Ø¥", "2",
		"Ø¤", "2",
		"Ø£", "2",
		"Ø¡", "2",
		"Ù ", "0",
		"Ù¡", "1",
		"Ù¢", "2",
		"Ù£", "3",
		"Ù¤", "4",
		"Ù¥", "5",
		"Ù¦", "6",
		"Ù§", "7",
		"Ù¨", "8",
		"Ù©", "9",
	},
	"Farsi": Map{
		"Ù¾", "p",
		"Ú†", "ch",
		"Ú˜", "zh",
		"Ú©", "k",
		"Ú¯", "g",
		"ÛŒ", "y",
		"\u200c", " ",
		"ØŸ", "?",
		"Ùª", "%",
		"Ø›", ";",
		"ØŒ", ":",
		"Û±", "1",
		"Û²", "2",
		"Û³", "3",
		"Û´", "4",
		"Ûµ", "5",
		"Û¶", "6",
		"Û·", "7",
		"Û¸", "8",
		"Û¹", "9",
		"Û°", "0",
		"Â»", "<",
		"Â«", ">",
		"Ù", "e",
		"Ù", "a",
		"Ù", "o",
		"Ù‘", "",
	},
	"Polish": Map{
		"Å", "L",
		"Å‚", "l",
	},
	"Lithuanian": Map{
		"Ä…", "a",
		"Ä", "c",
		"Ä™", "e",
		"Ä—", "e",
		"Ä¯", "i",
		"Å¡", "s",
		"Å³", "u",
		"Å«", "u",
		"Å¾", "z",
	},
	"Estonian": Map{
		"Ã¤", "a",
		"Ã„", "A",
		"Ã¶", "o",
		"Ãµ", "o",
		"Ã–", "O",
		"Ã•", "O",
		"Ã¼", "u",
		"Ãœ", "U",
	},
	"Icelandic": Map{
		"Ã", "Th",
		"Ã¾", "th",
		"Ã", "D",
		"Ã°", "d",
	},
	"Czeck": Map{
		"Å™", "r",
		"Ä›", "e",
		"Ã½", "y",
		"Ã¡", "a",
		"Ã­", "i",
		"Ã©", "e",
		"Ã³", "o",
		"Ãº", "u",
		"Å¯", "u",
		"Ä", "d",
		"Å¥", "t",
		"Åˆ", "n",
	},
	"French": Map{
		"Ã ", "a",
		"Ã¢", "a",
		"Ã©", "e",
		"Ã¨", "e",
		"Ãª", "e",
		"Ã«", "e",
		"Ã¹", "u",
		"Ã¼", "u",
		"Ã¿", "y",
		"Ã§", "c",
	},
	"Romanian": Map{
		"Äƒ", "a",
		"Ä‚", "A",
		"Ã¢", "a",
		"Ã‚", "A",
		"Ã®", "i",
		"Ã", "I",
		"È™", "s",
		"È˜", "S",
		"È›", "t",
		"Èš", "T",
		"ÅŸ", "s",
		"Å", "S",
		"Å£", "t",
		"Å¢", "T",
		"â€", "\"",
		"â€", "\"",
	},
	"Emoji": Map{
		"ğŸ˜‚", ":')",
		"ğŸ˜Š", ":)",
		"ğŸ˜ƒ", ":)",
		"ğŸ˜©", "-_-",
		"ğŸ˜", ":â€‘J",
		"ğŸ’œ", "<3",
		"ğŸ’–", "<3",
		"ğŸ’—", "<3",
		"â¤ï¸", "<3",
		"ğŸ’•", "<3",
		"ğŸ’", "<3",
		"ğŸ’˜", "<3",
		"ğŸ’“", "<3",
		"ğŸ’š", "<3",
		"ğŸ’™", "<3",
		"ğŸ’”", "</3",
		"ğŸ˜±", "D:",
		"ğŸ˜®", ":O",
		"ğŸ˜", ":P",
		"ğŸ˜", ":x",
		"ğŸ˜¢", ":(",
		"ğŸ’¯", ":100:",
		"ğŸ”¥", ":fire:",
		"ğŸ˜‰", ";)",
		"ğŸ˜´", ":zzz:",
		"ğŸ’¤", ":zzz:",
	},
	"Korean":   &KoreanTranslit{},
	"Chinese":  &ChineseTranslit{},
	"Armenian": &ArmenianTranslit{},
}
